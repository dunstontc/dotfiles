# Thank You Greg    https://github.com/wincent/wincent/blob/aa3a322e3a911dabe0ef398ebb1fd7c77209b8ac/roles/dotfiles/files/.tmux.conf
# Thank you Gregory https://github.com/gpakosz/.tmux/blob/master/.tmux.conf
# =============================================================================
#   General
# =============================================================================

set -g default-terminal "tmux-256color"
set -ga terminal-overrides ',xterm-256color:Tc'    # Enable true color

# Use the good old system clipboard
# set-option -g default-command "reattach-to-user-namespace -l $SHELL"
set-option -g default-command "reattach-to-user-namespace -l zsh"
# Aaand the mouse
set -g mouse on
set -s focus-events on                            # Needed as on tmux 1.9 and up (defaults to off).

# set -w -g xterm-keys on
set -s escape-time 0                              # No timeout after prefix
set -sg repeat-time 500                           # Increase repeat timeout

set -g prefix C-Space                             # Alter Prefix
unbind C-b
bind C-Space send-prefix

set -q -g status-utf8 on                          # expect UTF-8 (tmux < 2.2)
# set -w -q -g utf8 on

set -g history-limit 5000                         # boost history


# =============================================================================
#   Display
# =============================================================================

set -g base-index 1                         # start windows numbering at 1
set -w -g pane-base-index 1                 # make pane numbering consistent with windows

set -w -g automatic-rename on               # rename window to reflect current program
set -g renumber-windows on                  # renumber windows when a window is closed

set -g set-titles on                        # set terminal title
set -g set-titles-string ' 🎶 #S   🎵I #:) #W'
set -g set-titles-string ' 🎶 #S   🎵 #I: #W'
set -g display-panes-time 800               # slightly longer pane indicators display time
set -g display-time 1200                    # slightly longer status messages display time

set -g status-interval 10                   # redraw status line every 10 seconds, Default is 15.

# clear both screen and history
# bind -n C-l send-keys C-l \; run 'sleep 0.1' \; clear-history

# activity
set -w -g monitor-activity off
set -g visual-activity off

set -g clock-mode-colour '#00deaf'
set -g clock-mode-style 12


# =============================================================================
#   Unbindings
# =============================================================================
# Disable Ctrl+Arrows to maintain word jump
unbind C-Left
unbind C-Right
unbind C-Up
unbind C-Down
#  Pane Navigation
unbind h
unbind j
unbind k
unbind l # normally used for last-window
# Pane Resizing
unbind Left
unbind Right
unbind Down
unbind Up
# Window Navigation
unbind n
unbind p


# =============================================================================
#   Navigation
# =============================================================================
# bind vi key-mapping
set -g status-keys vi
# vi-style controls for copy mode
set -w -g mode-keys vi

# Reload configuration
bind r source-file ~/.tmux.conf \; display '~/.tmux.conf sourced'

# # create session
# bind C-c new-session

bind - split-window -v        # Split current window horizontally
bind \ split-window -h        # Split current window vertically

bind > swap-pane -D           # swap current pane with the next one
bind < swap-pane -U           # swap current pane with the previous one

bind -r Tab next-window       # navigate windows

# Pane resizing
bind -r Left resize-pane -L 5
bind -r Down resize-pane -D 5
bind -r Up resize-pane -U 5
bind -r Right resize-pane -R 5


# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n C-h if-shell "$is_vim" "send-keys C-h"  "select-pane -L"
bind-key -n C-j if-shell "$is_vim" "send-keys C-j"  "select-pane -D"
bind-key -n C-k if-shell "$is_vim" "send-keys C-k"  "select-pane -U"
bind-key -n C-l if-shell "$is_vim" "send-keys C-l"  "select-pane -R"
bind-key -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"
bind-key -T copy-mode-vi C-h select-pane -L
bind-key -T copy-mode-vi C-j select-pane -D
bind-key -T copy-mode-vi C-k select-pane -U
bind-key -T copy-mode-vi C-l select-pane -R
bind-key -T copy-mode-vi C-\ select-pane -l



# =============================================================================
#   Statusline
# =============================================================================
# show current settings:  $ tmux show-options -g | grep status

# #T - standard window title
# #h - short hostname
# #H - full hostname
# #S - session name
# #I - tmux window number
# #W - tmux window name
# #F - (*) Denotes the current window.

# very-light-gray: '#D4D4D4'
# light-gray:      '#808080'
# dark-gray:       '#282c34'
# very-dark-gray:  '#1E1E1E'
# light-red:       '#D16969'
# dark-red:        '#F44747'
# orange:          '#CE9178'
# light-yellow:    '#DCDCAA'
# dark-yellow:     '#D7BA7D'
# puke:            '#B5CEA8'
# comment-green:   '#608B4E'
# seafoam-green:   '#4EC9B0'
# light-blue:      '#9CDCFE'
# dark-blue:       '#569CD6'
# bright-blue:     '#007ACC'
# selection:       '#264F78'
# purple:          '#646695'
# pink:            '#C586C0'

# |        
# |      
#     
#                            ⏾
#             
#                      
# =============================================================================
# Messages
set -ag message-style fg="#4ec9b0"
set -ag message-style bg='#56b6c2'
set -ag message-style bg=default


# =============================================================================
# Panes
set -g pane-border-fg "#303030"
# set -g pane-border-bg "#303030"
set -g pane-active-border-fg "#303030"
# set -g pane-active-border-fg "#608B4E"
# set -g pane-active-border-bg "#608B4E"


# =============================================================================
#   Status Center
# =============================================================================
set -g status-fg '#4ec9b0'
set -g status-bg '#303030'
# set -g status-bg black

# Default Window Title
set -w -g window-status-fg white
set -w -g window-status-bg '#303030'
set -w -g window-status-attr italics
set -w -g window-status-format " #I:#W "

# Active Window Title
# set -w -g window-status-current-fg '#4ec9b0'
# set -w -g window-status-current-bg '#303030'
# set -w -g window-status-current-format " #I:#W "
# set -w -g window-status-current-format '#[fg=#608B4E,noitalics,bg=#303030] #[fg=white,italics,bg=#608B4E]#I:#[fg=white,bg=#608B4E]#W #[fg=#303030,noitalics,bg=#608B4E]'
# set -w -g window-status-current-format '#[fg=#608B4E,noitalics,bg=#303030] #[fg=white,italics,bg=#608B4E]#I:#W #[fg=#303030,noitalics,bg=#608B4E]'
# set -w -g window-status-current-format '#[fg=#608b4e,noitalics,bg=#303030] #[fg=#1e1e1e,noitalics,bg=#608B4e]#I: #(source ~/bin/display_tmux_pane_pwd.sh ) | #(cd #{pane_current_path}; git rev-parse --abbrev-ref HEAD) #[fg=#303030,noitalics,bg=#608b4e]'
# set -w -g window-status-current-format '#[fg=#608b4e,noitalics,bg=#303030] #[fg=#1e1e1e,noitalics,bg=#608B4e]#I: #{pane_current_path}   #(cd #{pane_current_path}; git rev-parse --abbrev-ref HEAD) #[fg=#303030,noitalics,bg=#608b4e]'
set -w -g window-status-current-format '#[fg=#608b4e,noitalics,bg=#303030] #[fg=#1e1e1e,noitalics,bg=#608B4e]#I: #{pane_current_path} #[fg=#303030,noitalics,bg=#608b4e]'


# =============================================================================
#   Status Left
# =============================================================================
# set -g status-left  "#[fg=black,bg=#404040]\ "
set -g status-left  "#[bg=black,fg=#303030]"
set -ag status-left "#[fg=#608b4e,italics,bg=#303030] #S ⧉ "           # Session
set -ag status-left "#[fg=#608b4e,italics,bg=#303030] "
# set -ag status-left "#[fg=#608B4E,italics,bg=#303030] "
# set -ag status-left "#[bg=#505050,noitalics,fg=#404040]"
# set -ag status-left "#[fg=#9CDCFE,italics,bg=#404040] #{uptime} "   # Uptime
# set -ag status-left "#[fg=#9CDCFE,italics,bg=#404040] #(source ~/bin/downtime) "   # Uptime
# set -ag status-left "#[bg=#404040,noitalics,fg=#303030]"
# set -ag status-left "#[fg=#4ec9b0,bg=#303030]\ "
# set -g status-left-length 250



# =============================================================================
#   Status Right
# =============================================================================
set -g status-right  "#{?client_prefix,⌨  ,} "                       # Let us know when the prefix is active
set -ag status-right "#{?window_zoomed_flag,🔭 ,} "                   # Let us know when we're zoomed in
# set -ag status-right "#[bg=#303030,noitalics,fg=#303030]"
set -ag status-right "#[fg=black,noitalics]  "
set -ag status-right "#[fg=#608B4E,italics,bg=#303030] #{battery_percentage} " # tmux-battery
# set -ag status-right "#[bg=#303030,noitalics,fg=#303030] "
set -ag status-right "#[fg=black,noitalics]  "
# set -ag status-right "#[fg=white,bg=#505050] %e %B "               # Date
set -ag status-right "#[fg=#608b4e,italics,bg=#303030] %I:%M %p "             # Time
# set -ag status-right "#[bg=#303030,noitalics,fg=#303030] "
set -ag status-right "#[fg=black,noitalics]  "
set -ag status-right "#[fg=#608b4e,italics,bg=#303030] #h "                  # Current Host
# set -ag status-right "#[fg=black,bg=#404040]\ "
set -ag status-right "#[bg=black,noitalics,fg=#303030]"
# set -g status-right-length 140


# =============================================================================
#   Plugins
# =============================================================================
setenv -g TMUX_PLUGIN_MANAGER_PATH '$HOME/.tmux/plugins/'
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-battery'
# 0-2, 3-5, 6-8, 9-1, 12-14, 15-17, 18-20, 21-12
# set -g @plugin 'pwittchen/tmux-plugin-uptime'
set -g @plugin "shuber/tmux-git"


run '~/.tmux/plugins/tpm/tpm'
